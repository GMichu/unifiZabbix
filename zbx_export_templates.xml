<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.4</version>
    <date>2021-10-08T00:25:22Z</date>
    <groups>
        <group>
            <uuid>15155c95a3d048f4856272ae12fd42c5</uuid>
            <name>Patrice</name>
        </group>
        <group>
            <uuid>e211bc7037224ae698133ce470303670</uuid>
            <name>Unifi</name>
        </group>
        <group>
            <uuid>0a316d3d60f64ef8aded36d48dd9d134</uuid>
            <name>unifiZabbix</name>
        </group>
        <group>
            <uuid>959165cff290432bbfbea50b4b247b0b</uuid>
            <name>Unifi Zabbix Export</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>3992b5de5504463d9538197893b1fdbc</uuid>
            <template>SunMAX SolarPoint</template>
            <name>SunMAX SolarPoint</name>
            <groups>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>304f50a34a7045dea1314f8317e25a7f</uuid>
                    <name>Battery Charge</name>
                    <type>DEPENDENT</type>
                    <key>batteryCharge</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.batteries[0].charge</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>91ff5c8032bd4589895de0596d34aa7b</uuid>
                    <name>Battery Voltage</name>
                    <type>DEPENDENT</type>
                    <key>batteryVoltage</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>V</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.batteries[0].voltage</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>483e7103e0c84bfa9c8c0ea957e61678</uuid>
                            <expression>nodata(/SunMAX SolarPoint/batteryVoltage,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported data in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <uuid>6ab05257f12a4e3b901a348edeba5817</uuid>
                            <expression>nodata(/SunMAX SolarPoint/batteryVoltage,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported data in more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not reported data in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/SunMAX SolarPoint/batteryVoltage,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>bfda151539714084bd37e8d04c3f544c</uuid>
                    <name>Net Power Consumption</name>
                    <type>CALCULATED</type>
                    <key>net_power_consumption</key>
                    <value_type>FLOAT</value_type>
                    <units>W</units>
                    <params>last(//pvInputPower) - last(//powerOutput)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2ddbf78585f147b7b6e2dc637d5f4e5e</uuid>
                    <name>Power Output</name>
                    <type>DEPENDENT</type>
                    <key>powerOutput</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>W</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.output.power</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>403d912eff154cd7870b795d4c98c1ab</uuid>
                    <name>Power Input from Solar Array</name>
                    <type>DEPENDENT</type>
                    <key>pvInputPower</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>W</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.pv.power</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>143059833e454233a6837519ffede9af</uuid>
                    <name>Voltage from Solar Array</name>
                    <type>DEPENDENT</type>
                    <key>pvInputVoltage</key>
                    <delay>0</delay>
                    <units>V</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.pv.voltage</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ad7ea49d3203477b96ee03c5984b8870</uuid>
                    <name>batteryJson</name>
                    <type>EXTERNAL</type>
                    <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1e16a0bf7ee34ce18fa42567d690c6d7</uuid>
                    <name>Output Voltage</name>
                    <type>DEPENDENT</type>
                    <key>voltageOutput</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>V</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.output.voltage</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Battery</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>64453202177f47eda7843e639609837d</uuid>
                    <name>Power Port Discovery</name>
                    <type>DEPENDENT</type>
                    <key>power_port_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>5ad15ebf54fc45b2a292c3d9e3ea6acd</uuid>
                            <name>{#PORT_NAME} Port Enabled</name>
                            <type>DEPENDENT</type>
                            <key>port__enabled_[{#PORT_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result[1].results.output.pins[ ?(@.name=='{#PORT_NAME}') ].enabled.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Battery</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8f39f76a05ff47aa8e6c8ef55bcebff1</uuid>
                            <name>{#PORT_NAME} Port Low Voltage</name>
                            <type>DEPENDENT</type>
                            <key>port__low_voltage_[{#PORT_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result[1].results.output.pins[ ?(@.name=='{#PORT_NAME}') ].low_voltage.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Battery</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>4528ebb39b1345889b79a2241b3945dd</uuid>
                                    <expression>last(/SunMAX SolarPoint/port__low_voltage_[{#PORT_NAME}],#1)=&quot;true&quot;</expression>
                                    <name>{#PORT_NAME} Port is in low voltage outage</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6e35c0a2518944448151e35b58e9e930</uuid>
                            <name>{#PORT_NAME} Port On</name>
                            <type>DEPENDENT</type>
                            <key>port__on_[{#PORT_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result[1].results.output.pins[ ?(@.name=='{#PORT_NAME}') ].on.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Battery</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2c30b45b07b04756a32e8ccfcf4bacc5</uuid>
                            <name>{#PORT_NAME} Port Suspended</name>
                            <type>DEPENDENT</type>
                            <key>port__suspended_[{#PORT_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result[1].results.output.pins[ ?(@.name=='{#PORT_NAME}') ].suspended.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Battery</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>7bd866530508400d99031acd429303f9</uuid>
                                    <expression>last(/SunMAX SolarPoint/port__suspended_[{#PORT_NAME}],#1)=&quot;true&quot;</expression>
                                    <name>{#PORT_NAME} Port is Suspended</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>solarpointBattery.sh[&quot;-u&quot;, &quot;{$SOLARPOINT_USERNAME}&quot;, &quot;-p&quot;, &quot;{$SOLARPOINT_PASSWORD}&quot;, {HOST.CONN}]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#PORT_NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.result[1].results.output.pins</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <uuid>0a98ef31467349b58d955569f2efc963</uuid>
            <template>UBNT Airmax</template>
            <name>UBNT Airmax</name>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>98f32cb2fb8449a89eb7cf0396995032</uuid>
                    <name>airTime</name>
                    <type>DEPENDENT</type>
                    <key>airTime</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>airTime=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>06da952714fd4428b21e92afb0b808d4</uuid>
                            <expression>nodata(/UBNT Airmax/airTime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} Device has not reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>e4abdaf9196b4fae98d3de636ac86573</uuid>
                            <expression>nodata(/UBNT Airmax/airTime,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} Device has not reported statistics in more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} Device has not reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/UBNT Airmax/airTime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>bb3c7aa6a2ad426e9eadd007eeff6452</uuid>
                    <name>AirTime Smooth</name>
                    <type>CALCULATED</type>
                    <key>airTimeSmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//airTime,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a4cccd4157544aa8a81230333ad1449c</uuid>
                    <name>CPU</name>
                    <type>DEPENDENT</type>
                    <key>cpuUsage</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>cpuUsage=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ad7da803e4d94e2b81d1f77b0d2b9950</uuid>
                    <name>loadavg</name>
                    <type>DEPENDENT</type>
                    <key>loadavg</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>loadavg=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2bc9a4f3da314707a94150cfe3963051</uuid>
                    <name>noise</name>
                    <type>DEPENDENT</type>
                    <key>noise</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>db</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>noise=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8fd7fbcd72594be7ac5077369f233cdb</uuid>
                    <name>Noise Smooth</name>
                    <type>CALCULATED</type>
                    <key>noiseSmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>dB</units>
                    <params>avg(//noise,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f5f349c1a3e549bebff177381fedff9f</uuid>
                    <name>signal</name>
                    <type>DEPENDENT</type>
                    <key>signal</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>db</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>signal=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2d04562fa0774125beef8043875a63ab</uuid>
                    <name>Signal Smooth</name>
                    <type>CALCULATED</type>
                    <key>signalSmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>dB</units>
                    <params>avg(//signal,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5fee14bc3d6447fbb7a56c75fecfa907</uuid>
                    <name>mca-status</name>
                    <type>SSH</type>
                    <key>ssh.run[mca-status]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>/bin/mca-status</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>{$UNIFI_USER}</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                </item>
                <item>
                    <uuid>b0b1603f6ce447a0a77551d8ba293fe8</uuid>
                    <name>wlanDownlinkCapacity</name>
                    <type>DEPENDENT</type>
                    <key>wlanDownlinkCapacity</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanDownlinkCapacity=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>1000</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>141c618d52af4523810a2053dfc2e07e</uuid>
                    <name>WAN Downlink Capacity Smooth</name>
                    <type>CALCULATED</type>
                    <key>wlanDownlinkCapacitySmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wlanDownlinkCapacity,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c878f4a3a9d14e4290f07c1b9fa1bd86</uuid>
                    <name>wlanRxBandwidth</name>
                    <type>DEPENDENT</type>
                    <key>wlanRxBandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanRxBytes=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>982b5677b12f49bdb0d5be89c4090fa2</uuid>
                    <name>WAN Reception Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>wlanRxBandwidthSmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wlanRxBandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>35b3f48548f04173a347f5696ed67512</uuid>
                    <name>wlanRxErrors</name>
                    <type>DEPENDENT</type>
                    <key>wlanRxErrors</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanRxErrors=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>52a83afd3e694a789073da60506066f7</uuid>
                    <name>wlanTxBandwidth</name>
                    <type>DEPENDENT</type>
                    <key>wlanTxBandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanTxBytes=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>eb50d36ade534adda015c481c883d6ea</uuid>
                    <name>WAN Transmission Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>wlanTxBandwidthSmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wlanTxBandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>37cd1176cf2c46b39e37d3074f80140a</uuid>
                    <name>wlanTxErrors</name>
                    <type>DEPENDENT</type>
                    <key>wlanTxErrors</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanTxErrors=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1ee6f64675294e7abe57c8754a9392b3</uuid>
                    <name>wlanUplinkCapacity</name>
                    <type>DEPENDENT</type>
                    <key>wlanUplinkCapacity</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>wlanUplinkCapacity=(.*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>1000</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mca-status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>82b243484217404e94c3ef38f5243af9</uuid>
                    <name>WAN Uplink Capacity Smooth</name>
                    <type>CALCULATED</type>
                    <key>wlanUplinkCapacitySmooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wlanUplinkCapacity,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
            </items>
        </template>
        <template>
            <uuid>a7de22ea581d4acf9dfc99de63c10f9d</uuid>
            <template>Unifi AP</template>
            <name>Unifi AP</name>
            <description>uses mca-dump via ssh to get AP info.

Assign this template to all APs in your site</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>Unifi</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>8895340dc23e470894fde1955a30bd5f</uuid>
                    <name>2G Channel Interference</name>
                    <type>CALCULATED</type>
                    <key>2g_interference</key>
                    <status>DISABLED</status>
                    <units>%</units>
                    <params>(last(//2g_interference_raw)&gt;0)*last(//2g_interference_raw)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8652e8953f8741dcacadd1c17c95a99c</uuid>
                    <name>2G Channel Interference raw</name>
                    <type>CALCULATED</type>
                    <key>2g_interference_raw</key>
                    <status>DISABLED</status>
                    <units>%</units>
                    <params>((last(//cu_total_2g)- last(//cu_self_tx_2g) - last(//cu_self_rx_2g))&gt;0)*(last(//cu_total_2g)- last(//cu_self_tx_2g) - last(//cu_self_rx_2g))</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>cf75968434a1434d861b7b06a42f03fd</uuid>
                            <expression>avg(/Unifi AP/2g_interference_raw,{$UNIFI_ALERT_PERIOD})&gt;50</expression>
                            <name>{HOST.NAME} 2G Interference &gt; 50%</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>208f094264094d428a054180ec4f73a8</uuid>
                    <name>2G Channel Interference Smooth</name>
                    <type>CALCULATED</type>
                    <key>2g_interference_smooth</key>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//2g_interference,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c4868a9ef2e44d188fae9e03ffd774e5</uuid>
                    <name>5G Channel Interference</name>
                    <type>CALCULATED</type>
                    <key>5g_interference</key>
                    <status>DISABLED</status>
                    <units>%</units>
                    <params>(last(//5g_interference_raw)&gt;0)*last(//5g_interference_raw)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>df795c4be187450084d5d418bfc89723</uuid>
                    <name>5G Channel Interference Raw</name>
                    <type>CALCULATED</type>
                    <key>5g_interference_raw</key>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(//cu_total_5g) - last(//cu_self_rx_5g) - last(//cu_self_tx_5g)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>c1fc0b2a82da4b4eb48105f385cfe730</uuid>
                            <expression>avg(/Unifi AP/5g_interference_raw,{$UNIFI_ALERT_PERIOD})&gt;30</expression>
                            <name>{HOST.NAME} 5G Interference &gt; 30%</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>c5a6f4f7bc524dc892c6f1d97cebba2c</uuid>
                    <name>5G Channel Interference Smooth</name>
                    <type>CALCULATED</type>
                    <key>5g_interference_smooth</key>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//5g_interference,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c0502d070bf24f8481781eed09b02e36</uuid>
                    <name>CPU Utilization</name>
                    <type>DEPENDENT</type>
                    <key>cpu</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.['system-stats'].cpu</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0a6a8fbeb5914c408e3614700e81d6ff</uuid>
                    <name>CPU Smooth</name>
                    <type>CALCULATED</type>
                    <key>cpu_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>39096049b1484feabd2d1788fa413791</uuid>
                    <name>2G Channel Utilization Smooth</name>
                    <type>CALCULATED</type>
                    <key>cu_avg_5mn_2g</key>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cu_total_2g,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7a954940ec7f426b9d2e16603e5af5c0</uuid>
                    <name>5G Channel Utilization Smooth</name>
                    <type>CALCULATED</type>
                    <key>cu_avg_5mn_5g</key>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cu_total_5g,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6aaaaacc8cb74a9885e291bc69d9de3d</uuid>
                    <name>2G Channel Usage Reception</name>
                    <type>DEPENDENT</type>
                    <key>cu_self_rx_2g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac != 'true')].athstats.cu_self_rx.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c0bb26a519964376a1576bcabcffaa1f</uuid>
                    <name>5G Channel Usage Reception</name>
                    <type>DEPENDENT</type>
                    <key>cu_self_rx_5g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac == 'true')].athstats.cu_self_rx.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1b2fee412a154dedade193ae369fc3c0</uuid>
                    <name>2G Channel Usage Transmission</name>
                    <type>DEPENDENT</type>
                    <key>cu_self_tx_2g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac != 'true')].athstats.cu_self_tx.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c27171ebbad14ea8b723f2bc5f40b942</uuid>
                    <name>5G Channel Usage Transmission</name>
                    <type>DEPENDENT</type>
                    <key>cu_self_tx_5g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac == 'true')].athstats.cu_self_tx.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>491fa23b90644b0f97f0234ac17baf65</uuid>
                    <name>2G Channel Usage Total</name>
                    <type>DEPENDENT</type>
                    <key>cu_total_2g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac != 'true')].athstats.cu_total.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>80b61c5fae364d7bb980798bd1c63a75</uuid>
                            <expression>avg(/Unifi AP/cu_total_2g,{$UNIFI_ALERT_PERIOD})&gt;60</expression>
                            <name>{HOST.NAME} 2G Channel Usage &gt; 60%</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} 2G Channel Usage &gt; 80%</name>
                                    <expression>avg(/Unifi AP/cu_total_2g,{$UNIFI_ALERT_PERIOD})&gt;80</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>594de384d46d456d8de6cd6c3fefcb48</uuid>
                            <expression>avg(/Unifi AP/cu_total_2g,{$UNIFI_ALERT_PERIOD})&gt;80</expression>
                            <name>{HOST.NAME} 2G Channel Usage &gt; 80%</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>881a89f14d4549d3ab1dab25ffd3875f</uuid>
                    <name>5G Channel Usage Total</name>
                    <type>DEPENDENT</type>
                    <key>cu_total_5g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac == 'true')].athstats.cu_total.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>8da227da0b974562af1fa8a4f80f8a4e</uuid>
                            <expression>avg(/Unifi AP/cu_total_5g,{$UNIFI_ALERT_PERIOD})&gt;60</expression>
                            <name>{HOST.NAME} 5G Channel Usage &gt; 60%</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} 5G Channel Usage &gt; 80%</name>
                                    <expression>avg(/Unifi AP/cu_total_5g,{$UNIFI_ALERT_PERIOD})&gt;80</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>16dd939288264f70979aa7349ccf9202</uuid>
                            <expression>avg(/Unifi AP/cu_total_5g,{$UNIFI_ALERT_PERIOD})&gt;80</expression>
                            <name>{HOST.NAME} 5G Channel Usage &gt; 80%</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>3dcc138706314816bb2ddc17c564ac70</uuid>
                    <name>Hostname</name>
                    <type>DEPENDENT</type>
                    <key>hostname</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.hostname</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d5b6cf216295410d8702946b303d9579</uuid>
                    <name>mca-dump</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                </item>
                <item>
                    <uuid>f07faffa28cc416483cf089bb94ec20a</uuid>
                    <name>Memory Utilization</name>
                    <type>CALCULATED</type>
                    <key>memory</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100* last(//mem_used) / last(//mem_total)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f49d35e7e8ec43299f27b8f4b24c042a</uuid>
                    <name>Total Memory</name>
                    <type>DEPENDENT</type>
                    <key>mem_total</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_total</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>67da102d9a6d4145bc7f7888d2c06e16</uuid>
                    <name>Memory Used</name>
                    <type>DEPENDENT</type>
                    <key>mem_used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_used</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>886f7aa596f2415685213dbe3fcb8dba</uuid>
                    <name>Model</name>
                    <type>DEPENDENT</type>
                    <key>model</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>MODEL</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.model_display</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5d88d1e4378b4d6a8a9b2bf7fbf717dc</uuid>
                    <name>2G Channel Retries</name>
                    <type>DEPENDENT</type>
                    <key>n_tx_xretries_2g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac != 'true')].athstats.n_tx_xretries.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7dc1bf272c564f7e98bcaaea5501c733</uuid>
                    <name>5G Channel Retries</name>
                    <type>DEPENDENT</type>
                    <key>n_tx_xretries_5g</key>
                    <delay>0</delay>
                    <status>DISABLED</status>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table.[?(@.is_11ac == 'true')].athstats.n_tx_xretries.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3c2df9c3ad504a71b43cd3eeaceb4f9d</uuid>
                    <name>Satisfaction</name>
                    <type>DEPENDENT</type>
                    <key>sat</key>
                    <delay>0</delay>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.satisfaction</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>-1</parameter>
                                <parameter>100</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>be561d7959ff4054a016af7adfd8b5c7</uuid>
                            <expression>avg(/Unifi AP/sat,{$UNIFI_ALERT_PERIOD})&lt;70</expression>
                            <name>{HOST.NAME} Satisfaction &lt; 70 %</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>3fef79609a14440e81aaf26bf796e93b</uuid>
                    <name>Satisfaction Smooth</name>
                    <type>CALCULATED</type>
                    <key>sat_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//sat,{$UNIFI_SMOOTHING_PERIOD})</params>
                </item>
                <item>
                    <uuid>1485697ffb9a4544b1b1db86704eafa9</uuid>
                    <name>Uptime</name>
                    <type>DEPENDENT</type>
                    <key>uptime</key>
                    <delay>0</delay>
                    <units>S</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.uptime</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2704aeb215474ad1bc494adfffd5d72a</uuid>
                            <expression>nodata(/Unifi AP/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>b8c15f7c71934ce89958890a93893a3b</uuid>
                            <expression>nodata(/Unifi AP/uptime,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics in more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} has not reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi AP/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>26900b13cdb742259963690fb57cf251</uuid>
                    <name>Wireless Reception Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>wireless_reception_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.vap_table.[*].rx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7a4ef25185b94148bd006ddb36ab13d6</uuid>
                    <name>Wireless Reception Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>wireless_reception_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wireless_reception_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7653b935e51940438db00a20e7ede1e2</uuid>
                    <name>Wireless Transmission Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>wireless_transmission_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.vap_table.[*].tx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>28ab515f715446e286ab7a88fe3499d8</uuid>
                    <name>Wireless Transmission Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>wireless_transmission_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//wireless_transmission_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>6e857bdd5a674e4e8be70b0e01d00d1a</uuid>
                    <name>Active Radio Discovery</name>
                    <type>DEPENDENT</type>
                    <key>active_radio_discovery</key>
                    <delay>0</delay>
                    <description>List all active radios to create channel items</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>f35732598f6f4aed84477b0932b496cb</uuid>
                            <name>Channel Interference {#RADIO_NAME}</name>
                            <type>CALCULATED</type>
                            <key>cint[{#RADIO_NAME}]</key>
                            <units>%</units>
                            <params>((last( //cu_total[{#RADIO_NAME}] )- last( //cu_tx[{#RADIO_NAME}])-last(//cu_rx[{#RADIO_NAME}]))&gt;0)*(last( //cu_total[{#RADIO_NAME}] )- last( //cu_tx[{#RADIO_NAME}])-last(//cu_rx[{#RADIO_NAME}]))</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>3f72d760eb204eceafe82682fbda16a5</uuid>
                                    <expression>avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}</expression>
                                    <name>{HOST.NAME}  {#RADIO_NAME} Channel Interference &gt; {$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                    <opdata>{$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:&quot;{#RADIO_NAME&quot;}</opdata>
                                    <priority>AVERAGE</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>e774c76335834241b15c4e203889e7e0</uuid>
                                    <expression>avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:&quot;{#RADIO_NAME&quot;}</expression>
                                    <name>{HOST.NAME}  {#RADIO_NAME} Channel Interference &gt; {$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                    <opdata>{$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:&quot;{#RADIO_NAME&quot;}</opdata>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{HOST.NAME}  {#RADIO_NAME} Channel Interference &gt; {$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                            <expression>avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>60ae3f2aea144c1bb42780bc424d7184</uuid>
                            <name>Channel Reception Utilization {#RADIO_NAME}</name>
                            <type>DEPENDENT</type>
                            <key>cu_rx[{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.radio_table[?(@.radio == '{#RADIO_NAME}')].athstats.cu_self_rx.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>466eee19400040749764a086133c4342</uuid>
                            <name>Channel Total Utilization {#RADIO_NAME}</name>
                            <type>DEPENDENT</type>
                            <key>cu_total[{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.radio_table[?(@.radio == '{#RADIO_NAME}')].athstats.cu_total.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>9047af0eb978454aab5768341986f29b</uuid>
                                    <expression>avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME&quot;}</expression>
                                    <name>{HOST.NAME}  {#RADIO_NAME} Channel Utilization &gt; {$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                    <opdata>{$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:&quot;{#RADIO_NAME}&quot;</opdata>
                                    <priority>AVERAGE</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>69372713ad284b79a905f5942c321b55</uuid>
                                    <expression>avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:&quot;{#RADIO_NAME}&quot;}</expression>
                                    <name>{HOST.NAME}  {#RADIO_NAME} Channel Utilization &gt; {$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                    <opdata>{$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:&quot;{#RADIO_NAME}&quot;</opdata>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{HOST.NAME}  {#RADIO_NAME} Channel Utilization &gt; {$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME}&quot;}%</name>
                                            <expression>avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})&gt;{$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:&quot;{#RADIO_NAME&quot;}</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>11b74b119dea413ea1152b15a8e3eacb</uuid>
                            <name>Channel Transmission Utilization {#RADIO_NAME}</name>
                            <type>DEPENDENT</type>
                            <key>cu_tx[{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.radio_table[?(@.radio == '{#RADIO_NAME}')].athstats.cu_self_tx.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>13bbc5518393491eb303198385799fbf</uuid>
                            <name>Channel Retries {#RADIO_NAME}</name>
                            <type>DEPENDENT</type>
                            <key>retries[{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.radio_table[?(@.radio == '{#RADIO_NAME}')].athstats.n_tx_xretries.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#RADIO_NAME}</lld_macro>
                            <path>$.radio</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.radio_table[?(@.athstats.cu_total &gt;0)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>90e43b647faa4a6fa7af643960bcf0a5</uuid>
                    <name>Wifi Network Discovery</name>
                    <type>DEPENDENT</type>
                    <key>wifi_network_discovery</key>
                    <delay>0</delay>
                    <description>Wifi Network Discovery Rule</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>99af4e53516341b1b4e40d814fe7a258</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Rx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>rx_bandwidth[{#ESSID}-{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.vap_table.[ ?(@.essid == '{#ESSID}' &amp;&amp; @.radio == '{#RADIO_NAME}' ) ].rx_bytes.sum()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3748f96463d74affa9340b398c34f1a0</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Reception Bandwidth Smooth</name>
                            <type>CALCULATED</type>
                            <key>rx_bandwidth_smooth[{#ESSID}-{#RADIO_NAME}]</key>
                            <value_type>FLOAT</value_type>
                            <units>bps</units>
                            <params>avg(//rx_bandwidth[{#ESSID}-{#RADIO_NAME}],{$UNIFI_SMOOTHING_PERIOD})</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b18528ee504149118ecc6aac93c51135</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Tx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>tx_bandwidth[{#ESSID}-{#RADIO_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.vap_table.[ ?(@.essid == &quot;{#ESSID}&quot;  &amp;&amp; @.radio == &quot;{#RADIO_NAME}&quot;) ].tx_bytes.sum()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ec606cedd02f45518d7a0c030b25849e</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Transmission Bandwidth Smooth</name>
                            <type>CALCULATED</type>
                            <key>tx_bandwidth_smooth[{#ESSID}-{#RADIO_NAME}]</key>
                            <value_type>FLOAT</value_type>
                            <units>bps</units>
                            <params>avg(//tx_bandwidth[{#ESSID}-{#RADIO_NAME}],{$UNIFI_SMOOTHING_PERIOD})</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>27c2c173f4d24b48b7341f0762c727a4</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Bandwidth</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi AP</host>
                                        <key>rx_bandwidth[{#ESSID}-{#RADIO_NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi AP</host>
                                        <key>tx_bandwidth[{#ESSID}-{#RADIO_NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ESSID}</lld_macro>
                            <path>$.essid</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#RADIO_NAME}</lld_macro>
                            <path>$.radio</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.vap_table</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$UNIFI_LOAD_AVERAGE_HIGH}</macro>
                    <value>4</value>
                </macro>
                <macro>
                    <macro>{$UNIFI_LOAD_AVERAGE_MEDIUM}</macro>
                    <value>3</value>
                </macro>
            </macros>
        </template>
        <template>
            <uuid>7d97fa717ee745cc8acc35152dfc93de</uuid>
            <template>Unifi Protect Camera</template>
            <name>Unifi Protect Camera</name>
            <description>Assign this to all the protect cameras to track availability and OS versions</description>
            <groups>
                <group>
                    <name>Unifi</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>844186fe9f6a45fab4b6d7e328a7a27a</uuid>
                    <name>Camera Name</name>
                    <type>DEPENDENT</type>
                    <key>camera_name</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>^Linux (\S*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[uname]</key>
                    </master_item>
                </item>
                <item>
                    <uuid>c5c93a248fa14b7aa37d35db3a0c9fe8</uuid>
                    <name>ping</name>
                    <type>SIMPLE</type>
                    <key>icmpping[]</key>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>6341d1bd42534d449d016021290e11cb</uuid>
                            <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                            <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>c92b0647b8284e2fa9bf10a16821b431</uuid>
                            <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                            <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>15a568e6472548a99053c4a8ca9ed924</uuid>
                    <name>MAC Address</name>
                    <type>DEPENDENT</type>
                    <key>Mac</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>MACADDRESS_A</inventory_link>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*HWaddr ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[ifconfig]</key>
                    </master_item>
                </item>
                <item>
                    <uuid>cdfa6a9fcacd4ec48cebab6137f5a3e7</uuid>
                    <name>Outoing Bandwidth Moving Average Threshold</name>
                    <type>DEPENDENT</type>
                    <key>outgoing_bandwidth_moving_average_threshold</key>
                    <delay>0</delay>
                    <units>Bps</units>
                    <preprocessing>
                        <step>
                            <type>IN_RANGE</type>
                            <parameters>
                                <parameter>0</parameter>
                                <parameter>160000000</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>8000000</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>outgoing_bandwidth_moving_average_threshold_raw</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Bandwidth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f72f7655c36840f0aa07c339921f4e32</uuid>
                    <name>Outoing Bandwidth Moving Average Threshold Raw</name>
                    <type>CALCULATED</type>
                    <key>outgoing_bandwidth_moving_average_threshold_raw</key>
                    <units>Bps</units>
                    <params>( 
last(//tx_bandwidth_smooth,#1:now-1d) +
last(//tx_bandwidth_smooth,#1:now-2d) +
last(//tx_bandwidth_smooth,#1:now-3d) +
last(//tx_bandwidth_smooth,#1:now-4d) +
last(//tx_bandwidth_smooth,#1:now-5d) +
last(//tx_bandwidth_smooth,#1:now-6d) +
last(//tx_bandwidth_smooth,#1:now-7d) 

) /7 * 0.5</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Bandwidth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2cef0436644d43b89057c680ee659c3f</uuid>
                    <name>Reception Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>rx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*RX bytes:(\d*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[ifconfig]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0081678ffe614bcd97836a30fd545d87</uuid>
                    <name>ifconfig</name>
                    <type>SSH</type>
                    <key>ssh.run[ifconfig]</key>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <params>if ifconfig eth0 &gt;/dev/null 2&gt;&amp;1 ; then ifconfig eth0; else ifconfig wlan0; fi</params>
                    <username>ubnt</username>
                    <password>{$PROTECT_CAMERA_PASSWORD}</password>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>f418ff4886b64345bf884ef541904a2f</uuid>
                            <expression>nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>Camera {HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>2117be829d9e4e34a1307d14cd387cc0</uuid>
                            <expression>nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>Camera {HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Camera {HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>accb9d8274d84bb8857c7d67eb934f21</uuid>
                    <name>uname</name>
                    <type>SSH</type>
                    <key>ssh.run[uname]</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <params>uname -a</params>
                    <username>ubnt</username>
                    <password>{$PROTECT_CAMERA_PASSWORD}</password>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>31105775931e445ca087eb65b0fcd3b1</uuid>
                    <name>Transmission Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>tx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*TX bytes:(\d*)</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[ifconfig]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ae881c785d1d4f7d9daf1ce86f0336ac</uuid>
                            <expression>avg(/Unifi Protect Camera/tx_bandwidth,10m)&lt;{$PROTECT_LOW_BANDWIDTH}</expression>
                            <name>Camera {HOST.NAME} Outgoing Bandwidth Low</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Camera {HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>d3577f5041954f47aba9bb8d5c71668e</uuid>
                    <name>Transmission Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>tx_bandwidth_smooth</key>
                    <units>bps</units>
                    <params>avg(//tx_bandwidth,1h)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
            </items>
        </template>
        <template>
            <uuid>cb5f1c2aac8d4779b50187acf329d2a3</uuid>
            <template>Unifi Protect Cloud Key</template>
            <name>Unifi Protect Cloud Key</name>
            <description>Assign this template to your Cloud Keys running Protect</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>4a94f51e12d747e1a363143c615c6baa</uuid>
                    <name>Incoming Bandwidth Moving Average Threshold</name>
                    <type>CALCULATED</type>
                    <key>incoming_bandwidth_moving_average_threshold</key>
                    <units>bps</units>
                    <params>(
avg(//IpExtInOctets,1h:now-1d)+
avg(//IpExtInOctets,1h:now-2d)+
avg(//IpExtInOctets,1h:now-3d)+
avg(//IpExtInOctets,1h:now-4d)+
avg(//IpExtInOctets,1h:now-5d)+
avg(//IpExtInOctets,1h:now-6d)+
avg(//IpExtInOctets,1h:now-7d)
) /7*.7</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Bandwidth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4f71cb1ac9534508b8b391414ee8345e</uuid>
                    <name>Incoming Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>IpExtInOctets</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.kernel.IpExtInOctets</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[nstat]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2fdd63693e6e444dbd76464a5ff19619</uuid>
                            <expression>nodata(/Unifi Protect Cloud Key/IpExtInOctets,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} hasn't reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>1e88147fdc28426f9b8d227993f6045e</uuid>
                            <expression>nodata(/Unifi Protect Cloud Key/IpExtInOctets,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} hasn't reported statistics in more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} hasn't reported statistics in more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi Protect Cloud Key/IpExtInOctets,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>017f3db264db4c1c801661a46f465e46</uuid>
                    <name>nstat</name>
                    <type>SSH</type>
                    <key>ssh.run[nstat]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>nstat -j -a</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>{$UNIFI_USER}</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e1d2e198baa2468fae4e354627b99bcd</uuid>
                    <name>Web Entry Point</name>
                    <type>HTTP_AGENT</type>
                    <key>web_app</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <url>https://{HOST.NAME}:7443</url>
                    <retrieve_mode>HEADERS</retrieve_mode>
                </item>
            </items>
        </template>
        <template>
            <uuid>5c308fb434614ef8acf2f94a04963cf4</uuid>
            <template>Unifi Protect NVR4</template>
            <name>Unifi Protect NVR4</name>
            <description>Assign this template to your UNVR4s running Protect</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>4d686eb0368b42ce8e90e854977e856c</uuid>
                    <name>CPU Idle</name>
                    <type>DEPENDENT</type>
                    <key>cpu_idle</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sysstat.hosts[0].statistics[0].cpuload[0].idle</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mpstat_nvr]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c55a4afc0d3f41f08ed439730558edf0</uuid>
                    <name>CPU smooth</name>
                    <type>CALCULATED</type>
                    <key>cpu_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cpu_utilization,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d5b94cccc9994d39b37aef02bbc0550a</uuid>
                    <name>CPU Utlization</name>
                    <type>CALCULATED</type>
                    <key>cpu_utilization</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100 - last(//cpu_idle)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9dcabffea95b4dd48e59fba2e3a2cbff</uuid>
                    <name>Incoming Bandwidth Moving Average Threshold</name>
                    <type>CALCULATED</type>
                    <key>incoming_bandwidth_moving_average_threshold</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>(
avg(//IpExtInOctets,1h:now-1d)+
avg(//IpExtInOctets,1h:now-2d)+
avg(//IpExtInOctets,1h:now-3d)+
avg(//IpExtInOctets,1h:now-4d)+
avg(//IpExtInOctets,1h:now-5d)+
avg(//IpExtInOctets,1h:now-6d)+
avg(//IpExtInOctets,1h:now-7d)
) /7*.7</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Bandwidth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5e773ded65124c77aaadbdc429ef69aa</uuid>
                    <name>Incoming Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>IpExtInOctets</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.kernel.IpExtInOctets</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[nstat]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>15608e1d1a9f45348dabb63eaf4c91b4</uuid>
                            <expression>nodata(/Unifi Protect NVR4/IpExtInOctets,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} hasn't reported statistics for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH High Priority Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>e4308a68f1df4a8e9ff7b3692a51355e</uuid>
                            <expression>nodata(/Unifi Protect NVR4/IpExtInOctets,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} hasn't reported statistics for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} hasn't reported statistics for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi Protect NVR4/IpExtInOctets,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH High Priority Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>e466492496544c28a4216331a5613846</uuid>
                    <name>nodename</name>
                    <type>DEPENDENT</type>
                    <key>nodename</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sysstat.hosts[0].nodename</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh.run[mpstat_nvr]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b85e01f40dc94e4da492ee6f9d5ca00c</uuid>
                    <name>mpstat</name>
                    <type>SSH</type>
                    <key>ssh.run[mpstat_nvr]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>mpstat -o JSON 1 1 | sed 's/&quot;cpu-load&quot;/&quot;cpuload&quot;/'</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>root</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>705b4fec2f7247fc9a9919a1669376ac</uuid>
                    <name>nstat</name>
                    <type>SSH</type>
                    <key>ssh.run[nstat]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>nstat -j -a</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>root</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cc50528fc52543a0972b0a325733a22e</uuid>
                    <name>Temp 1</name>
                    <type>SSH</type>
                    <key>ssh.run[temp1]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <value_type>FLOAT</value_type>
                    <units>ºC</units>
                    <params>cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp1_input</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>root</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>88dd5b446d504a84809b2372067e4a40</uuid>
                    <name>Temp 2</name>
                    <type>SSH</type>
                    <key>ssh.run[temp2]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <value_type>FLOAT</value_type>
                    <units>ºC</units>
                    <params>cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp2_input</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>root</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a0fb6f12fa4c443a8ba281155825bc38</uuid>
                    <name>Temp 3</name>
                    <type>SSH</type>
                    <key>ssh.run[temp3]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <value_type>FLOAT</value_type>
                    <units>ºC</units>
                    <params>cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp3_input</params>
                    <authtype>PUBLIC_KEY</authtype>
                    <username>root</username>
                    <publickey>{$UNIFI_PUB_KEY}</publickey>
                    <privatekey>{$UNIFI_PRIV_KEY}</privatekey>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.001</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>24cac6e713d04af5ac4be614c6829c15</uuid>
                    <name>Web Entry Point</name>
                    <type>HTTP_AGENT</type>
                    <key>web_app</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <url>https://{HOST.NAME}</url>
                    <retrieve_mode>HEADERS</retrieve_mode>
                </item>
            </items>
        </template>
        <template>
            <uuid>0dbc328172e34d8c8b7f3cdfd554d08d</uuid>
            <template>Unifi SSH High Priority Host</template>
            <name>Unifi SSH High Priority Host</name>
            <description>Link this template to NVRs and Gateways</description>
            <groups>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>fa8381770b744e4b9a717ceef7c569aa</uuid>
                    <name>ping</name>
                    <type>SIMPLE</type>
                    <key>icmpping[]</key>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>76db203cada54bdfa8fce55197989ca0</uuid>
                            <expression>max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                            <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>d392f22278464ef1bd4936d174f5b0cd</uuid>
                            <expression>max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                            <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>18d5b7b413a74fdeb09d1be567c80399</uuid>
                    <name>Load Average (1mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_1mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ee22be5cdc6a43019eeced4ab9505127</uuid>
                            <expression>nodata(/Unifi SSH High Priority Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>08593d21fb5441518507f2470a0acf5e</uuid>
                            <expression>nodata(/Unifi SSH High Priority Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH High Priority Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>aa7dcd5b4f1a4331a603b3780f31be20</uuid>
                    <name>Load Average (5mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_5mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: [^ ]*, ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c6d1b2905b3f4d29ae9729f32e775368</uuid>
                    <name>Load Average (15mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_15mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: [^ ]*, [^ ]*, ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cbfdeca6e1f8455db6bafe59b8693168</uuid>
                    <name>MAC Address A</name>
                    <type>DEPENDENT</type>
                    <key>mac_a</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>MACADDRESS_A</inventory_link>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*HWaddr|ether ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d7220ba9c416462fb768ecc14cd75253</uuid>
                    <name>MAC Address B</name>
                    <type>DEPENDENT</type>
                    <key>mac_b</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(HWaddr|ether)(.|\n)*(HWaddr|ether) ([a-fA-F0-9:]{17})</parameter>
                                <parameter>\4</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>N/A</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>23e04f2d4e9c4e09925eb8a65f0f41dc</uuid>
                    <name>ifconfig</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    <delay>1h</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bffe19ef0bca4cb296bf55c9ef69a612</uuid>
                    <name>Number of processors</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ]</key>
                    <delay>1d</delay>
                    <units>Processors</units>
                    <description>Number of processors</description>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[0-9]</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>1</error_handler_params>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Hardware</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2371bcddb5e64826a68de1ffd034bc1f</uuid>
                    <name>uname</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uname -a&quot; ]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>OS_FULL</inventory_link>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>61e39b8d10334b2eb0673169b3f54510</uuid>
                            <expression>change(/Unifi SSH High Priority Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uname -a&quot; ])=1</expression>
                            <name>{HOST.NAME} Version Change</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>73f78f9e0e3041f0a258cd41122fe3af</uuid>
                    <name>uptime</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
            </items>
        </template>
        <template>
            <uuid>f87a92acbcb54704a4d23aad9a19ab36</uuid>
            <template>Unifi SSH Host</template>
            <name>Unifi SSH Host</name>
            <description>Link this template to Unifi APs, Switches, USGes, UDMPs, Airmax devices hosts to get availability and version tracking on top of their specific template.

This will work with any SSH host with basic UNIX on the other side really.

Additionally,. this will fill the OS version and the MAC address in the inventory section.</description>
            <groups>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>d0b8592d9c5d4f55a2531ba748ad8ef2</uuid>
                    <name>ping</name>
                    <type>SIMPLE</type>
                    <key>icmpping[]</key>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2da72f8c38414846adab387f563819f3</uuid>
                            <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                            <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>08a60db01cd24b47bb1802c30c71359c</uuid>
                            <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                            <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>fa6026d048bb4efaba7e8b1caa187e82</uuid>
                    <name>Load Average (1mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_1mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>7cb4add2c2e44798a23f9a937872f322</uuid>
                            <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>301ff9308c3e4c2f9938a92226b443a5</uuid>
                            <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>763b62c5ec40413d97b4e9c127e65f61</uuid>
                    <name>Load Average (5mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_5mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: [^ ]*, ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1ead0560b5504179b4fededb31e952fa</uuid>
                    <name>Load Average (15mn)</name>
                    <type>DEPENDENT</type>
                    <key>load_avg_15mn</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*load average: [^ ]*, [^ ]*, ([0-9]+([.][0-9]+))</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>18f26cfa53744cbcba3f49581e546436</uuid>
                    <name>MAC Address A</name>
                    <type>DEPENDENT</type>
                    <key>mac_a</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>MACADDRESS_A</inventory_link>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>.*HWaddr|ether ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})</parameter>
                                <parameter>\1</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fb644aff10e7452586bc61429b3bb355</uuid>
                    <name>MAC Address B</name>
                    <type>DEPENDENT</type>
                    <key>mac_b</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(HWaddr|ether)(.|\n)*(HWaddr|ether) ([a-fA-F0-9:]{17})</parameter>
                                <parameter>\4</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>N/A</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2877b47ec7514bb392b4a4ba99c5af18</uuid>
                    <name>ifconfig</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;ifconfig&quot; ]</key>
                    <delay>1h</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Network</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ae2f6914da0f4ea7be6de28638e521c9</uuid>
                    <name>Number of processors</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ]</key>
                    <delay>1d</delay>
                    <units>Processors</units>
                    <description>Number of processors</description>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[0-9]</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>1</error_handler_params>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Hardware</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d1c0a1d2e0504e4391d297566e2e8465</uuid>
                    <name>uname</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uname -a&quot; ]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>OS_FULL</inventory_link>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>5558237e8dab41a0b5070c3dcf8120a3</uuid>
                            <expression>change(/Unifi SSH Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uname -a&quot; ])=1</expression>
                            <name>{HOST.NAME} Version Change</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>0cdc86cae6b742e4bf08e06e10d4da1b</uuid>
                    <name>uptime</name>
                    <type>EXTERNAL</type>
                    <key>ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;uptime&quot; ]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Availability</value>
                        </tag>
                        <tag>
                            <tag>Application</tag>
                            <value>Performance</value>
                        </tag>
                    </tags>
                </item>
            </items>
        </template>
        <template>
            <uuid>9b6c0fb011ee43549cb49302b36642d8</uuid>
            <template>Unifi Switch</template>
            <name>Unifi Switch</name>
            <description>Link this template to all Unifi switches</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>Unifi</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>ba86097608d94aec9f9bd74f965310d7</uuid>
                    <name>CPU Utilization</name>
                    <type>DEPENDENT</type>
                    <key>cpu</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.['system-stats'].cpu</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5ab9f788137f4ab9a8b38127d52fe141</uuid>
                    <name>CPU Smooth</name>
                    <type>CALCULATED</type>
                    <key>cpu_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3aab4c5928fe428eaa68c3ded3c966d8</uuid>
                    <name>Hostname</name>
                    <type>DEPENDENT</type>
                    <key>hostname</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.hostname</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c4668b5e15954379bbe9515188d96624</uuid>
                    <name>mca-dump</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3dbc59ea31d54d20b49a1b8aacbd31b0</uuid>
                    <name>mca-dump-feature-discovery</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH_FEATURE_DISCOVERY&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    <delay>15m</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Power</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ac98ab08a67a4bcba69e026763025344</uuid>
                    <name>Memory Utilization</name>
                    <type>CALCULATED</type>
                    <key>memory</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100* last(//mem_used) / last(//mem_total)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f767db4353aa4a24b373bcbd6a804ec1</uuid>
                    <name>Total Memory</name>
                    <type>DEPENDENT</type>
                    <key>mem_total</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_total</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6a239d18bcac4189a95a6631dc1dbfe3</uuid>
                    <name>Memory Used</name>
                    <type>DEPENDENT</type>
                    <key>mem_used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_used</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8be7925af1e84e088375e798ea0a0261</uuid>
                    <name>Model</name>
                    <type>DEPENDENT</type>
                    <key>model</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>MODEL</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.model_display</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d42df9b654fc4a2c88ed8e70106dca82</uuid>
                    <name>Total Rx Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>total_rx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table[*].rx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e89dd99080734254b3da3423f1b4549c</uuid>
                    <name>Total Tx Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>total_tx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table[*].tx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>48e7a8ec7bad4aa69a883adbf6564009</uuid>
                    <name>Uptime</name>
                    <type>DEPENDENT</type>
                    <key>uptime</key>
                    <delay>0</delay>
                    <units>S</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.uptime</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>83076110193e43139bc680e85132d099</uuid>
                            <expression>nodata(/Unifi Switch/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_LONG_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <uuid>61975534a4404efa8df675da2609c5f2</uuid>
                            <expression>nodata(/Unifi Switch/uptime,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>c63e03a538104cdebad4f428337e2952</uuid>
                    <name>Fan Discovery</name>
                    <type>DEPENDENT</type>
                    <key>fan_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>b84302d8102645eb882c4cec6131dddc</uuid>
                            <name>Fan Level</name>
                            <type>DEPENDENT</type>
                            <key>_[{#FAN_LEVEL_KEY_NAME}]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.fan_level</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH_FEATURE_DISCOVERY&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#FAN_LEVEL_KEY_NAME}</lld_macro>
                            <path>$.fan_level_key_name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.has_fan==&quot;true&quot;)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>3440ec98490a4b40bcc1dddca0955cb8</uuid>
                    <name>POE Discovery</name>
                    <type>DEPENDENT</type>
                    <key>poe_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>2ae16684b40b44adb53ae3363094beef</uuid>
                            <name>Max Power</name>
                            <type>DEPENDENT</type>
                            <key>_[{#MAX_POWER_KEY_NAME}]</key>
                            <delay>0</delay>
                            <units>W</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.total_max_power</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a8f107c6ff074de28b110c188b139f79</uuid>
                            <name>Percent Power Consumed</name>
                            <type>CALCULATED</type>
                            <key>_[{#PERCENT_POWER_CONSUMED_KEY_NAME}]</key>
                            <params>100 * last(//_[{#TOTAL_POWER_CONSUMED_KEY_NAME}]) / last(//_[{#MAX_POWER_KEY_NAME}])</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>318b0db443194b53afe55ccbda40bd4c</uuid>
                            <name>Total Power Consumed</name>
                            <type>DEPENDENT</type>
                            <key>_[{#TOTAL_POWER_CONSUMED_KEY_NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>W</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[*].poe_power.sum()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH_FEATURE_DISCOVERY&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#MAX_POWER_KEY_NAME}</lld_macro>
                            <path>$.max_power_key_name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PERCENT_POWER_CONSUMED_KEY_NAME}</lld_macro>
                            <path>$.percent_power_consumed_key_name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TOTAL_POWER_CONSUMED_KEY_NAME}</lld_macro>
                            <path>$.total_power_consumed_key_name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.power==&quot;true&quot;)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>ccacdb7fcb1c41d1a3e58f7a201e6603</uuid>
                    <name>POE Discovery by Port</name>
                    <type>DEPENDENT</type>
                    <key>poe_discovery_by_port</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>1793fb114e2d4fa3b40820d8c51e1d51</uuid>
                            <name>Power Consumed Port {#PORT_IDX}</name>
                            <type>DEPENDENT</type>
                            <key>power_consumed_port[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>W</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table.[ ?(@.port_idx=='{#PORT_IDX}') ].poe_power.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>e919a515e0b14d94aa0f3424f790c5a2</uuid>
                            <name>Power Consumed by Port {#PORT_IDX}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi Switch</host>
                                        <key>power_consumed_port[{#PORT_IDX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#PORT_IDX}</lld_macro>
                            <path>$.port_idx</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table[?(@.poe_power&gt;=0)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>2363ae0485a84853af24157aab6ed5f5</uuid>
                    <name>Switch Port Discovery</name>
                    <type>DEPENDENT</type>
                    <key>switch_port_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>2a70d96ce61f4e7facfd66e0acbad45e</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Connection Speed</name>
                            <type>DEPENDENT</type>
                            <key>connection_speed_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].speed.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>1000000</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>23118e1970b442b5a3b5f5645e48b6ad</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Uplink</name>
                            <type>DEPENDENT</type>
                            <key>is_uplink_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].is_uplink.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>05486e2ab46b41dca2e917db1211e680</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Rx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>rx_port_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].rx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a3e991eb253e4b6487dcef2fc1f11ca3</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} STP State</name>
                            <type>DEPENDENT</type>
                            <key>stp_state_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].stp_state.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6aa38f9c842746d0a77edb81dbf7d955</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Tx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>tx_port_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].tx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e39e30dea20544a8948f05f20155df79</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Up</name>
                            <type>DEPENDENT</type>
                            <key>up_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].up.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>ce61140da14e4a1ea919f2e083ee6835</uuid>
                            <expression>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)=&quot;true&quot; and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)=&quot;forwarding&quot; and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.25 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.25 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 25%</name>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 50%</name>
                                    <expression>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)=&quot;true&quot; and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)=&quot;forwarding&quot; and (  avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.5 )</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>054404edaf6b444a9c293b68a48a9adf</uuid>
                            <expression>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)=&quot;true&quot; and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)=&quot;forwarding&quot; and (  avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.5 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 50%</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 75%</name>
                                    <expression>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)=&quot;true&quot; and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)=&quot;forwarding&quot; and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.75 )</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>2bb9f140e9254b83b86f5318fd3a5240</uuid>
                            <expression>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)=&quot;true&quot; and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)=&quot;forwarding&quot; and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*.75 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 75%</name>
                            <priority>AVERAGE</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>573a52f59a844f798b12c86c12a7acd4</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Port I/O</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi Switch</host>
                                        <key>rx_port_[{#PORT_IDX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi Switch</host>
                                        <key>tx_port_[{#PORT_IDX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#LOCAL_PORT_NAME}</lld_macro>
                            <path>$.local_port_name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_IDX}</lld_macro>
                            <path>$.port_idx</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_IS_UPLINK}</lld_macro>
                            <path>$.is_uplink</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_MEDIA}</lld_macro>
                            <path>$.media</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>a520f7c4997947a4865af775a70e1ac7</uuid>
                    <name>Temperature Discovery</name>
                    <type>DEPENDENT</type>
                    <key>temperature_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>bb33a8f4a3ad4b44b1171de47669577e</uuid>
                            <name>Overheating</name>
                            <type>DEPENDENT</type>
                            <key>_[{#OVERHEATING_KEY_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.overheating</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1ee44c1518f441bd9ad5d3c585049926</uuid>
                            <name>Temperature</name>
                            <type>DEPENDENT</type>
                            <key>_[{#TEMPERATURE_KEY_NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ºC</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.general_temperature</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Power</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;SWITCH_FEATURE_DISCOVERY&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot; ]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#OVERHEATING_KEY_NAME}</lld_macro>
                            <path>$.overheating_key_name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TEMPERATURE_KEY_NAME}</lld_macro>
                            <path>$.temperature_key_name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.has_temperature==&quot;true&quot;)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$UNIFI_LOAD_AVERAGE_HIGH}</macro>
                    <value>5</value>
                </macro>
                <macro>
                    <macro>{$UNIFI_LOAD_AVERAGE_MEDIUM}</macro>
                    <value>4</value>
                </macro>
            </macros>
        </template>
        <template>
            <uuid>8838e1f9216740ef85fc1dcd9aa40470</uuid>
            <template>Unifi UDMP</template>
            <name>Unifi UDMP</name>
            <description>Link this template to UDMPs</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>18f6381b1c3648b297fbcd37afd8c4b6</uuid>
                    <name>CPU Utilization</name>
                    <type>DEPENDENT</type>
                    <key>cpu</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.['system-stats'].cpu</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9204754ee4064cdb86e7363d0712bbd3</uuid>
                    <name>CPU Smooth</name>
                    <type>CALCULATED</type>
                    <key>cpu_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>37128fdaf8a44d3ca2dd43030aeda754</uuid>
                    <name>Download Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>download_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_bytes.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>afe932a0c79e417ca73a2ab03d7b7c51</uuid>
                    <name>Download Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>download_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//download_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3f6a016441704b88bf6e46b8e7197978</uuid>
                    <name>Dropped Dowload Packets</name>
                    <type>DEPENDENT</type>
                    <key>dropped_dowload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_dropped.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>429298f385a04a27b174f4043179c6c1</uuid>
                    <name>Dropped Upload Packets</name>
                    <type>DEPENDENT</type>
                    <key>dropped_upload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_dropped.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8c6a8688114c426a8a6c7df47e295239</uuid>
                    <name>Error Download Packets</name>
                    <type>DEPENDENT</type>
                    <key>error_download_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_errors.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f7dec452d1d4457ca0bf5acf2b60190f</uuid>
                    <name>Error Upload Packets</name>
                    <type>DEPENDENT</type>
                    <key>error_upload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_errors.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e205941cf309403cb90a79a2c77c79db</uuid>
                    <name>Hostname</name>
                    <type>DEPENDENT</type>
                    <key>hostname</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.hostname</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0340d3a39faf4ab9a318780d4514aa3c</uuid>
                    <name>Hourly Direct Port 53 Requests</name>
                    <type>CALCULATED</type>
                    <key>hourly_port_53_requests</key>
                    <history>21d</history>
                    <params>count(//port_53_abuser_request,3600s)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>DNS</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0a0bd902e984402bb28fa7e7506f4471</uuid>
                    <name>Port 53 Abuser Request Raw</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>logrt[&quot;/mnt/data/log/messages(\.[0-9])?&quot;,&quot;user.warn kernel.*SRC=(([0-9]{1,3}\.){3}[0-9]{1,3}) DST=(([0-9]{1,3}\.){3}[0-9]{1,3}).*DPT=8?53 .*&quot;,,,,&quot;[ { \&quot;ip\&quot;: \&quot;\1\&quot;, \&quot;dns_server\&quot;:\&quot;\3\&quot; } ]&quot;]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>DNS</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8eb698db79b94fa18684ebcee01876b7</uuid>
                    <name>mca-dump</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>edc477cd12ed4a09b0229145ab0dac8b</uuid>
                    <name>Memory Utilization</name>
                    <type>CALCULATED</type>
                    <key>memory</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100* last(//mem_used) / last(//mem_total)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6d11b4ee4bfd4e46876003b76ab98f8b</uuid>
                    <name>Total Memory</name>
                    <type>DEPENDENT</type>
                    <key>mem_total</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_total</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fc15813aadcf4ab0a7fce520edead1d0</uuid>
                    <name>Memory Used</name>
                    <type>DEPENDENT</type>
                    <key>mem_used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_used</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ce371d643fa241f08754f455091c7f12</uuid>
                    <name>Model</name>
                    <type>DEPENDENT</type>
                    <key>model</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>MODEL</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.model_display</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>974499717ff54afb888c14d7a32c5f1a</uuid>
                    <name>Port 53 Abuser Request</name>
                    <type>DEPENDENT</type>
                    <key>port_53_abuser_request</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <master_item>
                        <key>logrt[&quot;/mnt/data/log/messages(\.[0-9])?&quot;,&quot;user.warn kernel.*SRC=(([0-9]{1,3}\.){3}[0-9]{1,3}) DST=(([0-9]{1,3}\.){3}[0-9]{1,3}).*DPT=8?53 .*&quot;,,,,&quot;[ { \&quot;ip\&quot;: \&quot;\1\&quot;, \&quot;dns_server\&quot;:\&quot;\3\&quot; } ]&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>DNS</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c55c2e9872e844f19c9aa535454baf74</uuid>
                    <name>Temperature CPU</name>
                    <type>DEPENDENT</type>
                    <key>temperature.cpu</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>ºC</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.temperatures.[?(@.name == 'CPU')].value.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3f57027299814f168fae8f8abdc621c1</uuid>
                    <name>Temperature PHY</name>
                    <type>DEPENDENT</type>
                    <key>temperature.phy</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>ºC</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.temperatures.[?(@.name == 'PHY')].value.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ff07a3572bfa4f089c7abf60cdc45163</uuid>
                    <name>Total Switch Rx Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>total_switch_rx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <description>Total Bandwidth Received by the 8 port switch embedded in the UDMP (ports 1-8)</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table[?(@.port_idx &lt; 9)].rx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1ef97d3bf6b84e179d80ffe44c00bb40</uuid>
                    <name>Total Switch Tx Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>total_switch_tx_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <description>Total Bandwidth Sent by the 8 port switch embedded in the UDMP (ports 1-8)</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table[?(@.port_idx &lt; 9)].tx_bytes.sum()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b5b81d4dab514d4680b987094da82541</uuid>
                    <name>Upload Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>upload_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_bytes.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5e6cf6da2cb44182baaba87fe67ca65b</uuid>
                    <name>Upload Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>upload_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//upload_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ba7054579a914ad4aa25941fc192c3aa</uuid>
                    <name>Uptime</name>
                    <type>DEPENDENT</type>
                    <key>uptime</key>
                    <delay>0</delay>
                    <units>S</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.uptime</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>fc389a5acbc440af96c4e7ee27765feb</uuid>
                            <expression>nodata(/Unifi UDMP/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>b592d4299ef9482496c585caa936112c</uuid>
                            <expression>nodata(/Unifi UDMP/uptime,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not report statistics for more than {$UNIFI_ALERT_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not reported statistics for more than {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi UDMP/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>8d57c1175b0b4f74b2d0add7c66a4e22</uuid>
                    <name>WAN Latency</name>
                    <type>DEPENDENT</type>
                    <key>wan_latency</key>
                    <delay>0</delay>
                    <units>ms</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].latency.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1a7dca58d5974370b682310f019b78cf</uuid>
                    <name>Wan Latency Smooth</name>
                    <type>CALCULATED</type>
                    <key>wan_latency_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>ms</units>
                    <params>avg(//wan_latency,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>85739b2b715a4246a543ebfdaa9aeb73</uuid>
                    <name>Network Discovery</name>
                    <type>DEPENDENT</type>
                    <key>network_discovery</key>
                    <delay>0</delay>
                    <description>Network Discovery</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>3120f764520c4881af4d5f84116dacb1</uuid>
                            <name>{#NETWORK_NAME} VLAN Reception Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>vlan_rx_bandwitdh[{#NETWORK_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.network_table[ ?(@.address == '{#NETWORK_NAME}' ) ].stats.rx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cf0082a5d087409d8bf36cf4f9b954ae</uuid>
                            <name>{#NETWORK_NAME} VLAN Transmission Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>vlan_tx_bandwitdh[{#NETWORK_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.network_table[ ?(@.address == '{#NETWORK_NAME}' ) ].stats.tx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>7a62b41d75314aea883418cf203a38d9</uuid>
                            <name>{#NETWORK_NAME} Inter-VLAN Bandwidth</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>vlan_rx_bandwitdh[{#NETWORK_NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>vlan_tx_bandwitdh[{#NETWORK_NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NETWORK_NAME}</lld_macro>
                            <path>$.address</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.network_table[?(@.active_dhcp_lease_count&gt;0)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>8f93ed4e9efa4b13ad9df0cc0766a4cc</uuid>
                    <name>Port 53 discovery abuser</name>
                    <type>DEPENDENT</type>
                    <key>port_53_abuser_discovery</key>
                    <delay>0</delay>
                    <lifetime>2d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>492f7deff4c44b699b3f79fbd89f4c83</uuid>
                            <name>Hourly Port 53 Requests from {#ABUSER}</name>
                            <type>CALCULATED</type>
                            <key>hourly_port_53_requests_[{#ABUSER}]</key>
                            <value_type>FLOAT</value_type>
                            <params>count(//port_53_abuser_request,3600s,&quot;like&quot;,&quot;\&quot;{#ABUSER}\&quot;&quot;)</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>DNS</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>logrt[&quot;/mnt/data/log/messages(\.[0-9])?&quot;,&quot;user.warn kernel.*SRC=(([0-9]{1,3}\.){3}[0-9]{1,3}) DST=(([0-9]{1,3}\.){3}[0-9]{1,3}).*DPT=8?53 .*&quot;,,,,&quot;[ { \&quot;ip\&quot;: \&quot;\1\&quot;, \&quot;dns_server\&quot;:\&quot;\3\&quot; } ]&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ABUSER}</lld_macro>
                            <path>$.ip</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#DNS_SERVER}</lld_macro>
                            <path>$.dns_server</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>a0838ea024db492b8c3d1c904dfb8315</uuid>
                    <name>Port 53 discovery DNS server</name>
                    <type>DEPENDENT</type>
                    <key>port_53_dns_server_discovery</key>
                    <delay>0</delay>
                    <lifetime>2d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>ce121518b98d452fa1e62cac9522d00d</uuid>
                            <name>Hourly Port 53 Requests to {#DNS_SERVER}</name>
                            <type>CALCULATED</type>
                            <key>hourly_port_53_requests_to_[{#DNS_SERVER}]</key>
                            <value_type>FLOAT</value_type>
                            <params>count(//port_53_abuser_request,3600s,&quot;like&quot;,&quot;\&quot;{#DNS_SERVER}\&quot;&quot;)</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>DNS</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>logrt[&quot;/mnt/data/log/messages(\.[0-9])?&quot;,&quot;user.warn kernel.*SRC=(([0-9]{1,3}\.){3}[0-9]{1,3}) DST=(([0-9]{1,3}\.){3}[0-9]{1,3}).*DPT=8?53 .*&quot;,,,,&quot;[ { \&quot;ip\&quot;: \&quot;\1\&quot;, \&quot;dns_server\&quot;:\&quot;\3\&quot; } ]&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ABUSER}</lld_macro>
                            <path>$.ip</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#DNS_SERVER}</lld_macro>
                            <path>$.dns_server</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>58568f925c7c4f7bb44800d431141b69</uuid>
                    <name>Site to Site VPN Discovery</name>
                    <type>DEPENDENT</type>
                    <key>site_to_site_vpn_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>c797de40215b4b99a2e6fec77cbf6d6e</uuid>
                            <name>Remote Site Rx Bandwidth - {#REMOTE_SITE_IP}</name>
                            <type>DEPENDENT</type>
                            <key>remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.vpn[*].remotes[?(@.ip  == '{#REMOTE_SITE_IP}')].rxRate.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>699f174819c64cf79820addab60c3a67</uuid>
                            <name>Remote Site Tx Bandwidth - {#REMOTE_SITE_IP}</name>
                            <type>DEPENDENT</type>
                            <key>remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.vpn[*].remotes[?(@.ip  == '{#REMOTE_SITE_IP}')].txRate.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>25bf1af2bd6b4629bd724b6251d197c1</uuid>
                            <name>Remote Site Bandwidth - {#REMOTE_SITE_IP}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#REMOTE_SITE_IP}</lld_macro>
                            <path>$.ip</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.vpn[*].remotes[0]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>c4593426190a422dbdf3341a066c4214</uuid>
                    <name>Switch Port Discovery</name>
                    <type>DEPENDENT</type>
                    <key>switch_port_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>679a3e2856dd46c6a966843c44738a5b</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Connection Speed</name>
                            <type>DEPENDENT</type>
                            <key>connection_speed_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].speed.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>1000000</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1b52fd26f9654509a911f6a43d8658ab</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Uplink</name>
                            <type>DEPENDENT</type>
                            <key>is_uplink_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].is_uplink.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0d02ff3c40e94f4b9c0495fafc3f9a1c</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Rx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>rx_port_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].rx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>78a554f976144a7ea4db83051148a91b</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Tx Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>tx_port_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].tx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c42462fcfe1e47b4abc2ca083d18d458</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Up</name>
                            <type>DEPENDENT</type>
                            <key>up_[{#PORT_IDX}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.port_table[ ?(@.port_idx=='{#PORT_IDX}')].up.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>6e678d3587d944b8bb4a87b7a5ef5935</uuid>
                            <expression>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)=&quot;true&quot; and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.25 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.25 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 25%</name>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 50%</name>
                                    <expression>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)=&quot;true&quot; and (  avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 )</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>14c2ce7629714ff38b1ed1fcaae6ebd3</uuid>
                            <expression>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)=&quot;true&quot; and (  avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 50%</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 75%</name>
                                    <expression>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)=&quot;true&quot; and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 )</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>37beea9d4c814e8f8818ddc65c207e3c</uuid>
                            <expression>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)&gt;0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)=&quot;true&quot; and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})&gt;last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 )</expression>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} above 75%</name>
                            <priority>AVERAGE</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>877968bc3fbb4d2daf2421e3e4b31569</uuid>
                            <name>{{#PORT_IS_UPLINK}.regsub(&quot;true&quot;, &quot;Uplink&quot;)} {{#PORT_MEDIA}.regsub(&quot;SFP&quot;, \0)} Port {#PORT_IDX} Port I/O</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>rx_port_[{#PORT_IDX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi UDMP</host>
                                        <key>tx_port_[{#PORT_IDX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;root&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;UDMP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#LOCAL_PORT_NAME}</lld_macro>
                            <path>$.local_port_name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_IDX}</lld_macro>
                            <path>$.port_idx</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_IS_UPLINK}</lld_macro>
                            <path>$.is_uplink</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#PORT_MEDIA}</lld_macro>
                            <path>$.media</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.port_table</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$UNIFI_USER}</macro>
                    <value>root</value>
                    <description>AP Zabbix SSH Username - UDMP only supports root</description>
                </macro>
            </macros>
        </template>
        <template>
            <uuid>f15020131b5c4b7b96100df9faedce9c</uuid>
            <template>Unifi USG</template>
            <name>Unifi USG</name>
            <description>Link this template to USGs</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>81d276921081468c895ca7c7d9b3e918</uuid>
                    <name>CPU Utilization</name>
                    <type>DEPENDENT</type>
                    <key>cpu</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.['system-stats'].cpu</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4412da02249643e5a550d06ec615fba8</uuid>
                    <name>CPU Smooth</name>
                    <type>CALCULATED</type>
                    <key>cpu_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bd014f86f61b49f9986807955f0ced54</uuid>
                    <name>Download Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>download_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_bytes.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>06f18573d1074e1ca3e8a3410718f84c</uuid>
                    <name>Download Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>download_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//download_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ecf022ac405d40df9eab71535db74efb</uuid>
                    <name>Dropped Dowload Packets</name>
                    <type>DEPENDENT</type>
                    <key>dropped_dowload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_dropped.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>25fe82aeddae4bcaaf9200938f5bf374</uuid>
                    <name>Dropped Upload Packets</name>
                    <type>DEPENDENT</type>
                    <key>dropped_upload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_dropped.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ba029bfe37ed46afb282ddf488ad85e2</uuid>
                    <name>Error Download Packets</name>
                    <type>DEPENDENT</type>
                    <key>error_download_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].rx_errors.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7c5b5eca37ba42c2be32eb0557911a58</uuid>
                    <name>Error Upload Packets</name>
                    <type>DEPENDENT</type>
                    <key>error_upload_packets</key>
                    <delay>0</delay>
                    <units>packet</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_errors.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a5aeed02d2de40468e2b803199236775</uuid>
                    <name>Hostname</name>
                    <type>DEPENDENT</type>
                    <key>hostname</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.hostname</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>01ee1019a6924fb68849a55218890a6f</uuid>
                    <name>mca-dump</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b563bf45785f4115aebbe863be59d5b3</uuid>
                    <name>Memory Utilization</name>
                    <type>CALCULATED</type>
                    <key>memory</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100* last(//mem_used) / last(//mem_total)</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ea425dc7ad9441e4a98d3dda70d686f0</uuid>
                    <name>Total Memory</name>
                    <type>DEPENDENT</type>
                    <key>mem_total</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_total</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>85a3e058622143858b1d03f42e8502ea</uuid>
                    <name>Memory Used</name>
                    <type>DEPENDENT</type>
                    <key>mem_used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.sys_stats.mem_used</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7b26ad9b743a40a19158e509e8d805a9</uuid>
                    <name>Model</name>
                    <type>DEPENDENT</type>
                    <key>model</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>MODEL</inventory_link>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.model_display</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8599d352cdda477c80879089f13354d7</uuid>
                    <name>Temperature CPU</name>
                    <type>DEPENDENT</type>
                    <key>temperature.cpu</key>
                    <delay>0</delay>
                    <units>ºC</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..temps.CPU.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter> C</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8aff108a17754957b7af5385e653fd46</uuid>
                    <name>Temperature PHY</name>
                    <type>DEPENDENT</type>
                    <key>temperature.phy</key>
                    <delay>0</delay>
                    <units>ºC</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..temps.PHY.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter> C</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>02c08e3965f44f07a54f7335dd5f5099</uuid>
                    <name>Upload Bandwidth</name>
                    <type>DEPENDENT</type>
                    <key>upload_bandwidth</key>
                    <delay>0</delay>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].tx_bytes.first()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>8</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c31da23a358c4c4b91265816b3429db6</uuid>
                    <name>Upload Bandwidth Smooth</name>
                    <type>CALCULATED</type>
                    <key>upload_bandwidth_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <params>avg(//upload_bandwidth,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4a8bde0252204cbe912780251a386e7e</uuid>
                    <name>Uptime</name>
                    <type>DEPENDENT</type>
                    <key>uptime</key>
                    <delay>0</delay>
                    <units>S</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.uptime</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>d3885f1a41b64c6c811997ecb8f324f5</uuid>
                            <expression>nodata(/Unifi USG/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics for {$UNIFI_ALERT_LONG_PERIOD}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <uuid>4da4bf931fc3455a9c92a4ff2153518f</uuid>
                            <expression>nodata(/Unifi USG/uptime,{$UNIFI_ALERT_PERIOD})=1</expression>
                            <name>{HOST.NAME} has not reported statistics for {$UNIFI_ALERT_PERIOD}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOST.NAME} has not reported statistics for {$UNIFI_ALERT_LONG_PERIOD}</name>
                                    <expression>nodata(/Unifi USG/uptime,{$UNIFI_ALERT_LONG_PERIOD})=1</expression>
                                </dependency>
                                <dependency>
                                    <name>{HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                                    <expression>nodata(/Unifi SSH Host/load_avg_1mn,{$UNIFI_ALERT_PERIOD})=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>8ea02a18a7b34d388b8189e7182aa386</uuid>
                    <name>WAN Latency</name>
                    <type>DEPENDENT</type>
                    <key>wan_latency</key>
                    <delay>0</delay>
                    <units>ms</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.if_table.[?(@.latency &gt; 0)].latency.first()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>673fc15b8624479089f70a6c8ab34ba7</uuid>
                    <name>Wan Latency Smooth</name>
                    <type>CALCULATED</type>
                    <key>wan_latency_smooth</key>
                    <value_type>FLOAT</value_type>
                    <units>ms</units>
                    <params>avg(//wan_latency,{$UNIFI_SMOOTHING_PERIOD})</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>wan</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>feb50bd260ce4553a47bb89eeb5e46e8</uuid>
                    <name>Network Discovery</name>
                    <type>DEPENDENT</type>
                    <key>network_discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>2e6f9468a3464faa9f2407d046fa723f</uuid>
                            <name>{#NETWORK_NAME} VLAN Reception Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>vlan_rx_bandwitdh[{#NETWORK_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.network_table[ ?(@.name == '{#NETWORK_NAME}' ) ].stats.rx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1521ead6676944f881eb0ec1abe3d5ee</uuid>
                            <name>{#NETWORK_NAME} VLAN Transmission Bandwidth</name>
                            <type>DEPENDENT</type>
                            <key>vlan_tx_bandwitdh[{#NETWORK_NAME}]</key>
                            <delay>0</delay>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.network_table[ ?(@.name == '{#NETWORK_NAME}' ) ].stats.tx_bytes.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Traffic</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>85d0ab43c9024020818f5678c63ac6bf</uuid>
                            <name>{#NETWORK_NAME} Inter-VLAN Bandwidth</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi USG</host>
                                        <key>vlan_rx_bandwitdh[{#NETWORK_NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi USG</host>
                                        <key>vlan_tx_bandwitdh[{#NETWORK_NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;USG&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NETWORK_NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.network_table[?(@.up==&quot;true&quot;)]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <uuid>c706ce3839514b87885842955e0865bf</uuid>
            <template>Unifi WiFi Site</template>
            <name>Unifi WiFi Site</name>
            <description>This template is meant to collect WiFi data across all of a site's APs.  Assign to one of the APs and set the {$UNIFI_AP_GROUP} macro to the name of a group that contains all of the APs you want to aggregate against.</description>
            <groups>
                <group>
                    <name>Patrice</name>
                </group>
                <group>
                    <name>unifiZabbix</name>
                </group>
                <group>
                    <name>Unifi Zabbix Export</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>1c4533c25fae47e8a07189c280f8f502</uuid>
                    <name>Total Reception Wireless Bandwidth</name>
                    <type>CALCULATED</type>
                    <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;wireless_reception_bandwidth&quot;,avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                    <units>bps</units>
                    <params>sum(avg_foreach(/*/wireless_reception_bandwidth?[group=&quot;{$AP_GROUP}&quot;],{$UNIFI_SMOOTHING_PERIOD}))</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f8bc0b7fbcea4e108b9339e385ef085f</uuid>
                    <name>Total Transmission Wireless Bandwidth</name>
                    <type>CALCULATED</type>
                    <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;wireless_transmission_bandwidth&quot;,avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                    <units>bps</units>
                    <params>sum(avg_foreach(/*/wireless_transmission_bandwidth?[group=&quot;{$AP_GROUP}&quot;],{$UNIFI_SMOOTHING_PERIOD}))</params>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Radio</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>24671ab8f5d44096b16f5e5b1dcb9326</uuid>
                    <name>mca-dump</name>
                    <type>EXTERNAL</type>
                    <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    <delay>{$UNIFI_CHECK_FREQUENCY}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Host</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>e8e0ef9c01f0409e9a649e0f69ea50cf</uuid>
                    <name>Discover WiFi Networks</name>
                    <type>DEPENDENT</type>
                    <key>wifi_network_discovery_rule</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>460c978a4cfb40b1930c4a47dac748e9</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Total Reception Bandwidth</name>
                            <type>CALCULATED</type>
                            <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;rx_bandwidth[{#ESSID}-{#RADIO_NAME}]&quot;, avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                            <value_type>FLOAT</value_type>
                            <units>bps</units>
                            <params>sum(avg_foreach(/*/rx_bandwidth[{#ESSID}-{#RADIO_NAME}]?[group=&quot;{$AP_GROUP}&quot;],{$UNIFI_SMOOTHING_PERIOD}))</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c91e55731b9d4dae8fb3d5d1ab8e1cb0</uuid>
                            <name>{#ESSID}-{#RADIO_NAME} Total Transmission Bandwidth</name>
                            <type>CALCULATED</type>
                            <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;tx_bandwidth[{#ESSID}-{#RADIO_NAME}]&quot;, avg, &quot;{$UNIFI_SMOOTHING_PERIOD}&quot;]</key>
                            <value_type>FLOAT</value_type>
                            <units>bps</units>
                            <params>sum(avg_foreach(/*/tx_bandwidth[{#ESSID}-{#RADIO_NAME}]?[group=&quot;{$AP_GROUP}&quot;],{$UNIFI_SMOOTHING_PERIOD}))</params>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Radio</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>4487c510b1ad4c5a940cfad9acc63266</uuid>
                            <name>{#ESSID} Bandwidth</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Unifi WiFi Site</host>
                                        <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;rx_bandwidth[{#ESSID}-{#RADIO_NAME}]&quot;, avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Unifi WiFi Site</host>
                                        <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;tx_bandwidth[{#ESSID}-{#RADIO_NAME}]&quot;, avg, &quot;{$UNIFI_SMOOTHING_PERIOD}&quot;]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>mca-dump-short.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-t&quot;, &quot;AP&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ESSID}</lld_macro>
                            <path>$.essid</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#RADIO_NAME}</lld_macro>
                            <path>$.radio</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.vap_table</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$AP_GROUP}</macro>
                    <value>Override me!</value>
                    <description>The name of the group containing the site MAPs</description>
                </macro>
            </macros>
        </template>
    </templates>
    <triggers>
        <trigger>
            <uuid>10f0713611da4380a8120294fc928a08</uuid>
            <expression>last(/Unifi Protect Camera/tx_bandwidth_smooth,#1) &lt; last(/Unifi Protect Camera/outgoing_bandwidth_moving_average_threshold_raw,#1) and last(/Unifi Protect Camera/tx_bandwidth,#1) &lt; last(/Unifi Protect Camera/outgoing_bandwidth_moving_average_threshold_raw,#1)</expression>
            <name>Camera {HOST.NAME} Outgoing Bandwidth Low</name>
            <priority>INFO</priority>
            <dependencies>
                <dependency>
                    <name>Camera {HOST.NAME} has not been pingable for more than {$UNIFI_ALERT_PERIOD}</name>
                    <expression>max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0</expression>
                </dependency>
                <dependency>
                    <name>Camera {HOST.NAME} Outgoing Bandwidth Low</name>
                    <expression>avg(/Unifi Protect Camera/tx_bandwidth,10m)&lt;{$PROTECT_LOW_BANDWIDTH}</expression>
                </dependency>
                <dependency>
                    <name>Camera {HOST.NAME} SSH has not been available for more than {$UNIFI_ALERT_PERIOD}</name>
                    <expression>nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_PERIOD})=1</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <uuid>986b14fb36e8416ca24d2af88b06b613</uuid>
            <expression>avg(/Unifi Protect Cloud Key/IpExtInOctets,3600s) &lt; last(/Unifi Protect Cloud Key/incoming_bandwidth_moving_average_threshold,#1)</expression>
            <name>{HOST.NAME} Incoming Bandwidth Too Low</name>
            <priority>WARNING</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <uuid>8e2e73da9a224f61b24511db3c331864</uuid>
            <expression>avg(/Unifi Protect NVR4/IpExtInOctets,1h) &lt; last(/Unifi Protect NVR4/incoming_bandwidth_moving_average_threshold,#1)</expression>
            <name>{HOST.NAME} Incoming Bandwidth Too Low</name>
            <priority>WARNING</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <uuid>52cec550f270441f9c5cdd764897ce53</uuid>
            <expression>last(/Unifi Protect NVR4/ssh.run[temp1],#1)&gt;{$UNIFI_ALERT_TEMP} or last(/Unifi Protect NVR4/ssh.run[temp2],#1)&gt;{$UNIFI_ALERT_TEMP} or last(/Unifi Protect NVR4/ssh.run[temp3],#1)&gt;{$UNIFI_ALERT_TEMP}</expression>
            <name>{HOST.NAME} is hot</name>
            <priority>WARNING</priority>
        </trigger>
        <trigger>
            <uuid>d71b7c4cdb084f10b4556d2cadd84f8d</uuid>
            <expression>last(/Unifi SSH High Priority Host/load_avg_15mn,#1)&gt;last(/Unifi SSH High Priority Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}</expression>
            <name>{HOST.NAME} load average is &gt; {$UNIFI_LOAD_AVERAGE_HIGH} per processor</name>
            <priority>WARNING</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <uuid>665ee1289cf94f318e26c9e7474e4229</uuid>
            <expression>last(/Unifi SSH Host/load_avg_15mn,#1)&gt;last(/Unifi SSH Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}</expression>
            <name>{HOST.NAME} load average is &gt; {$UNIFI_LOAD_AVERAGE_HIGH} per processor</name>
            <priority>WARNING</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <uuid>b601c0fbee6e48668ec03ff912b5304c</uuid>
            <expression>last(/Unifi SSH High Priority Host/load_avg_15mn,#1)&gt;last(/Unifi SSH High Priority Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_MEDIUM}</expression>
            <name>{HOST.NAME} Load average is &gt; {$UNIFI_LOAD_AVERAGE_MEDIUM} per processor</name>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>{HOST.NAME} load average is &gt; {$UNIFI_LOAD_AVERAGE_HIGH} per processor</name>
                    <expression>last(/Unifi SSH High Priority Host/load_avg_15mn,#1)&gt;last(/Unifi SSH High Priority Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <uuid>22986a62ed9b40ec9c89acecff5045fa</uuid>
            <expression>last(/Unifi SSH Host/load_avg_15mn,#1)&gt;last(/Unifi SSH Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_MEDIUM}</expression>
            <name>{HOST.NAME} Load average is &gt; {$UNIFI_LOAD_AVERAGE_MEDIUM} per processor</name>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>{HOST.NAME} load average is &gt; {$UNIFI_LOAD_AVERAGE_HIGH} per processor</name>
                    <expression>last(/Unifi SSH Host/load_avg_15mn,#1)&gt;last(/Unifi SSH Host/ssh-run.sh[&quot;-d&quot;,&quot;{HOST.CONN}&quot;, &quot;-u&quot;, &quot;{$UNIFI_USER}&quot;, &quot;-i&quot;, &quot;{$UNIFI_SSH_PRIV_KEY_PATH}&quot;, &quot;-p&quot;, &quot;{$UNIFI_SSHPASS_PASSWORD_PATH}&quot;, &quot;nproc&quot; ],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}</expression>
                </dependency>
            </dependencies>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <uuid>6800f3a3becb44ffbabb02587276d1c5</uuid>
            <name>Air Time</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>UBNT Airmax</host>
                        <key>airTimeSmooth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>97ccfef4197444c69af57ca79513fd16</uuid>
            <name>Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi Protect NVR4</host>
                        <key>IpExtInOctets</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi Protect NVR4</host>
                        <key>incoming_bandwidth_moving_average_threshold</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>a1b1190f8dfa4c9694f69132ea7027a2</uuid>
            <name>Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>download_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>upload_bandwidth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>fad2952510f34a4897c8194393d3e6e3</uuid>
            <name>Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi Protect Camera</host>
                        <key>rx_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi Protect Camera</host>
                        <key>tx_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Unifi Protect Camera</host>
                        <key>tx_bandwidth_smooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>Unifi Protect Camera</host>
                        <key>outgoing_bandwidth_moving_average_threshold_raw</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>d09d7d135dfc49d0b35e2a0ed5d2ac20</uuid>
            <name>Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi USG</host>
                        <key>download_bandwidth_smooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi USG</host>
                        <key>upload_bandwidth_smooth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>0d21337806de4d03bda1b762c0a98ee4</uuid>
            <name>Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>wireless_reception_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>wireless_transmission_bandwidth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>dd9c1e7a2b6a44a590a8ce1e131e75ed</uuid>
            <name>Bandwidth Used</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>UBNT Airmax</host>
                        <key>wlanRxBandwidthSmooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>UBNT Airmax</host>
                        <key>wlanTxBandwidthSmooth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>8853a3813ca8403eb6199379f8349834</uuid>
            <name>Charge and Voltage</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <yaxisside>RIGHT</yaxisside>
                    <item>
                        <host>SunMAX SolarPoint</host>
                        <key>batteryCharge</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>SunMAX SolarPoint</host>
                        <key>batteryVoltage</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>f7f3c8e61e564d0d9f8057f70d9c0072</uuid>
            <name>CPU and Memory</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>cpu</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>77b6b90c95ee43ed89899a355d9449f0</uuid>
            <name>CPU and Memory</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi Switch</host>
                        <key>cpu_smooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi Switch</host>
                        <key>memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>347ef23ef5a94b629dabcc89b74331a0</uuid>
            <name>CPU and Memory</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi USG</host>
                        <key>cpu_smooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi USG</host>
                        <key>memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>2cec753f0a24451fb95a06fd19a0ae8d</uuid>
            <name>Incoming Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi Protect Cloud Key</host>
                        <key>IpExtInOctets</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi Protect Cloud Key</host>
                        <key>incoming_bandwidth_moving_average_threshold</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>6df36bdd292345d092b9ed6e545ced1e</uuid>
            <name>Interference and Channel Usage</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>2g_interference_raw</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>cu_total_2g</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>5g_interference</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>Unifi AP</host>
                        <key>cu_total_5g</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>10507414af274cf19b4bc87a2b85d55d</uuid>
            <name>Latency</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>wan_latency</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>47ef7a2c34d24f75bb0453105a57974e</uuid>
            <name>Load Averages</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi SSH Host</host>
                        <key>load_avg_1mn</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi SSH Host</host>
                        <key>load_avg_15mn</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Unifi SSH Host</host>
                        <key>load_avg_5mn</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>cd4b89f3fff24baf877bcf444a62f05d</uuid>
            <name>Load Averages</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi SSH High Priority Host</host>
                        <key>load_avg_1mn</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi SSH High Priority Host</host>
                        <key>load_avg_15mn</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Unifi SSH High Priority Host</host>
                        <key>load_avg_5mn</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>defcfe28a659470c929684a6c51957fe</uuid>
            <name>Power I/O</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>SunMAX SolarPoint</host>
                        <key>net_power_consumption</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>01686902f0154cc99cf027792a39adc9</uuid>
            <name>Signal and Noise</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>UBNT Airmax</host>
                        <key>noiseSmooth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>UBNT Airmax</host>
                        <key>signalSmooth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>32f787121dc94a769829896a44364785</uuid>
            <name>Total Embedded Switch Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>total_switch_rx_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi UDMP</host>
                        <key>total_switch_tx_bandwidth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>160a7ded8ed04fbdba40c5126962be4a</uuid>
            <name>Total Traffic</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi Switch</host>
                        <key>total_rx_bandwidth</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi Switch</host>
                        <key>total_rx_bandwidth</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>aa28d9dbd34e4cdfb0e4447dbdb171ef</uuid>
            <name>Total WiFi Bandwidth</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Unifi WiFi Site</host>
                        <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;wireless_reception_bandwidth&quot;,avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Unifi WiFi Site</host>
                        <key>grpsum[&quot;{$AP_GROUP}&quot;, &quot;wireless_transmission_bandwidth&quot;,avg, {$UNIFI_SMOOTHING_PERIOD}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
